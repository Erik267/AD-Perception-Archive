# TrajEdit: Closed-loop Data Augmentation for Autonomous Driving

## 0. åŸºæœ¬ä¿¡æ¯
- **æ—¶é—´**: 2024/2025 (ICLR 2025)
- **ä½œè€…å•ä½**: ç™¾åº¦, åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡
- **ä¸“ä¸š Tags**: `Trajectory Editing`, `Closed-loop Augmentation`, `Physics-Consistency`

## 1. ğŸ”ª ä»Šæ—¥é”è¯„
**ç‰©ç†ç—›ç‚¹**: è§£å†³äº†æ•°æ®å¢å¼ºä¸­çš„ **â€œéç‰©ç†æ¼‚ç§»â€** ç°è±¡ã€‚ç®€å•çš„å¹³ç§»å¢å¼ºä¼šä½¿è½¦è¾†è½¨è¿¹è¿èƒŒéå®Œæ•´æ€§çº¦æŸã€‚TrajEdit ä¿è¯äº†æ‰€æœ‰ç”Ÿæˆçš„å¢å¼ºè½¨è¿¹åœ¨åŠ¨åŠ›å­¦ä¸Šæ˜¯å¯æ‰§è¡Œçš„ï¼Œæœ‰æ•ˆæ‰©å……äº†é•¿å°¾è½¬å¼¯åœºæ™¯çš„æ•°æ®é›†è´¨é‡ã€‚

## 2. ğŸ—ï¸ æ¨¡å‹æ¶æ„ (Architecture Map)
- **Trajectory Analyzer**: åˆ†æåŸå§‹è½¨è¿¹çš„æ›²ç‡ä¸é€Ÿåº¦åˆ†å¸ƒã€‚
- **Flat-space Editor**: åœ¨å¾®åˆ†å¹³å¦ç©ºé—´ï¼ˆDifferential Flatness Spaceï¼‰è¿›è¡Œå¾®æ‰°ç¼–è¾‘ã€‚
- **Consistency Checker**: éªŒè¯ç¼–è¾‘åçš„è½¨è¿¹æ˜¯å¦ç¬¦åˆè½¦è¾†åŠ¨åŠ›å­¦æé™ã€‚

## 3. ğŸ’¡ æ ¸å¿ƒåˆ›æ–° (Math & Pseudo-code)
**åŸºäºå¾®åˆ†å¹³å¦æ€§çš„è½¨è¿¹ç¼–è¾‘ (Flatness-based Editing)**:
```python
# Pseudo-code for Physics-Consistent Augmentation
# raw_traj: [T, 2] (x, y)
def physics_augment(raw_traj):
    # 1. Map to Flat Space (x, y, theta, kappa)
    flat_states = traj_to_flat(raw_traj)
    # 2. Apply Perturbation in Flat Space (Guaranteed valid)
    aug_flat = flat_states + torch.randn_like(flat_states) * 0.1
    # 3. Reconstruct back to Control Space (v, steer)
    aug_traj = flat_to_traj(aug_flat)
    return aug_traj
```

## 4. ğŸ“‰ Loss å‡½æ•°è¯¦è§£
- **$L_{const}$**: åŠ¨åŠ›å­¦çº¦æŸæƒ©ç½šé¡¹ã€‚
- **$L_{smooth}$**: è½¨è¿¹å¹³æ»‘åº¦æŸå¤±ã€‚

## 7. ğŸ§© æ—¶åºä¸ç¨³å®šæ€§ (Temporal Stability)
- **Jerk Minimization**: è‡ªåŠ¨å¹³æ»‘ç¼–è¾‘åçš„è½¨è¿¹ï¼Œæ¶ˆé™¤æ§åˆ¶æŒ‡ä»¤çš„é˜¶è·ƒè·³åŠ¨ã€‚

## 10. ğŸ› ï¸ è½åœ°å»ºè®® (Deployment)
- **ç¦»çº¿å¢å¼º**: è¯¥å·¥å…·æœ€é€‚åˆåœ¨æ•°æ®é—­ç¯çš„é¢„å¤„ç†ç¯èŠ‚ä½¿ç”¨ï¼Œç”¨äºç”Ÿæˆé«˜ä¿çœŸåº¦çš„è™šæ‹Ÿè®­ç»ƒæ ·æœ¬ã€‚
