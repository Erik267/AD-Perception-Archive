# OccSora: 4D World Generation for Autonomous Driving

## 0. 基本信息
- **时间**: 2024/2025 (CVPR 2025)
- **作者单位**: 上海人工智能实验室 (Shanghai AI Lab), 清华大学
- **官方代码**: [https://github.com/scu-vcl-ai/OccSora](https://github.com/scu-vcl-ai/OccSora)
- **专业 Tags**: `4D Occupancy`, `World Model`, `Diffusion Model`, `Generative AD`

## 1. 🔪 今日锐评
**物理痛点**: 传统的 3D Occupancy 只是“死”的体素堆叠，缺乏对时间维度的物理连续性建模。OccSora 解决了 **“幻觉演化”** 问题——即感知模型在预测未来时，体素会发生不符合物理规律的突变或消失。它让自动驾驶系统拥有了类似人类的“时空预判”能力。

## 2. 🏗️ 模型架构 (Architecture Map)
- **输入**: 多目图像特征 + 当前状态 $S_t$。
- **数据流**: 
  1. **Spatial-Temporal VAE**: 将高维 4D 占用图压缩至潜空间 (Latent Space)。
  2. **Diffusion Transformer (DiT)**: 在潜空间进行时空特征建模。
  3. **Conditioning**: 结合 Ego-motion 和文本描述，引导生成。
- **特征维度**: $4D 	ext{ Tensor: } [B, T, C, H, W, D]$，通过 VAE 压缩至 $[B, T, c, h, w, d]$。

## 3. 💡 核心创新 (Math & Pseudo-code)
**4D 占用图潜空间扩散**:
```python
# PyTorch 风格伪代码 (Conceptual)
def forward(x_0, cond_ego):
    t = torch.randint(0, T_max, (B,))
    x_t = q_sample(x_0, t, epsilon) # 加噪过程
    # DiT Predict Noise
    pred_noise = model_dit(x_t, t, cond_ego) 
    loss = MSE(pred_noise, epsilon)
    return loss
```

## 4. 📉 Loss 函数详解
- **$L_{diff}$**: 潜空间扩散损失。
- **$L_{rec}$**: VAE 重构损失。
- **$L_{phys}$**: 物理一致性约束。

## 5. 📊 关键指标 (SOTA Compare)
- **FVD (Frechet Video Distance)**: 较之前 SOTA 提升了 35%。
- **mIoU**: 在 4D 预测任务中达到顶级水平。

## 10. 🛠️ 落地建议
- **算子合并**: 扩散模型推理极慢，建议将 VAE Decoder 部分进行 TensorRT 算子融合。
- **硬件同步**: 对 IMU 的实时性要求极高。
