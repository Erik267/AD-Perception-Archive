# GenAD: Generative End-to-End Driving with World Model

## 0. åŸºæœ¬ä¿¡æ¯
- **æ—¶é—´**: 2024/2025 (CVPR 2025)
- **ä½œè€…å•ä½**: è‡ªåŠ¨é©¾é©¶å¼€æºç¤¾åŒº, ä¸Šæµ·äº¤é€šå¤§å­¦
- **ä¸“ä¸š Tags**: `Generative AI`, `Data Closed-loop`, `End-to-End`, `World Model`

## 1. ğŸ”ª ä»Šæ—¥é”è¯„
**ç‰©ç†ç—›ç‚¹**: è§£å†³äº†ç«¯åˆ°ç«¯é©¾é©¶åœ¨ **â€œåäº‹å®åœºæ™¯ï¼ˆCounterfactual Scenariosï¼‰â€** ä¸‹çš„è¯„ä¼°éš¾é¢˜ã€‚ä¼ ç»Ÿæ–¹æ³•æ— æ³•å›ç­”â€œå¦‚æœæˆ‘å½“æ—¶å·¦è½¬ä¼šå‘ç”Ÿä»€ä¹ˆâ€ï¼Œè€Œ GenAD é€šè¿‡ç”Ÿæˆå¼ä¸–ç•Œæ¨¡å‹ï¼Œè®©è‡ªè½¦åœ¨æ½œç©ºé—´å†…è¿›è¡Œâ€œæ¨æ¼”â€ï¼Œä»æµ·é‡æ¨¡æ‹Ÿçš„å¤±è´¥ä¸­å­¦ä¹ æˆåŠŸçš„è·¯å¾„ã€‚

## 2. ğŸ—ï¸ æ¨¡å‹æ¶æ„ (Architecture Map)
- **Latent World Model**: åŸºäº Transformer çš„çŠ¶æ€è¿ç§»æ–¹ç¨‹ï¼Œé¢„æµ‹æ½œç©ºé—´æ¼”åŒ–ã€‚
- **Generative Decoder**: å°†æ½œç©ºé—´çŠ¶æ€ $z$ è¿˜åŸä¸ºç¯è§†è§†é¢‘æµï¼Œç”¨äºè§†è§‰éªŒè¯ã€‚
- **Policy Network**: åœ¨ç”Ÿæˆçš„è™šæ‹Ÿè½¨è¿¹ä¸Šè¿›è¡Œå¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ã€‚

## 3. ğŸ’¡ æ ¸å¿ƒåˆ›æ–° (Math & Pseudo-code)
**ç”Ÿæˆå¼é—­ç¯å­¦ä¹  (Generative Closed-loop Learning)**:
```python
# Pseudo-code for Generative Planning
# z_t: [B, 512], action_candidates: [B, K, 6, 2]
def evaluate_trajectories(z_t, action_candidates):
    scores = []
    for traj in action_candidates:
        # 1. Imagine future states in Latent Space
        future_zs = self.world_model.rollout(z_t, traj)
        # 2. Predict rewards/costs (e.g., collision probability)
        cost = self.cost_critic(future_zs)
        scores.append(cost)
    # 3. Select min cost traj
    best_traj = action_candidates[torch.argmin(scores)]
    return best_traj
```

## 4. ğŸ“‰ Loss å‡½æ•°è¯¦è§£
- **$L_{gen}$**: è§†é¢‘ç”Ÿæˆçš„é‡å»ºè¯¯å·®ï¼ˆL1 + Perceptual Lossï¼‰ã€‚
- **$L_{dyn}$**: æ½œç©ºé—´åŠ¨åŠ›å­¦é¢„æµ‹è¯¯å·® $\text{MSE}(z_{t+1}, \hat{z}_{t+1})$ã€‚

## 5. ğŸ“Š å…³é”®æŒ‡æ ‡ (SOTA Compare)
- **SR (Success Rate)**: åœ¨å¤æ‚åŸå¸‚åœºæ™¯ä»¿çœŸä¸­ï¼Œè¾ƒä¼ ç»Ÿé—­ç¯æ–¹æ³•æå‡ 25%ã€‚

## 6. ğŸ“‚ æ•°æ®ç­–ç•¥ä¸é¢„å¤„ç†
- **Counterfactual Reasoning**: ç»™å®šä¸€æ¡å±é™©è½¨è¿¹ï¼Œæ¨¡å‹ç”Ÿæˆå¯¹åº”çš„è§†è§‰æ¼”åŒ–ç»“æœï¼Œå¹¶è®¡ç®—è¯¥è½¨è¿¹çš„ç”Ÿå­˜ä»£ä»·ã€‚

## 10. ğŸ› ï¸ è½åœ°å»ºè®® (Deployment)
- **æ¨¡å‹è’¸é¦**: ç”Ÿæˆå¼ç»„ä»¶ä½“ç§¯å·¨å¤§ï¼Œå»ºè®®å°†è¯„ä¼°åçš„â€œæœ€ä¼˜ç­–ç•¥â€è’¸é¦åˆ°è½»é‡çº§çš„ MLP ç½‘ç»œä¸­è¿›è¡Œå®è½¦éƒ¨ç½²ã€‚
