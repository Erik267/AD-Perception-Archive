---
date: 2026-02-27
keywords: [UniAD, Unified Autonomous Driving, End-to-End, CVPR 2023 Best Paper]
tags: [Level-03, Perception-to-Planning, Unified-Query]
---

# UniAD-è®ºæ–‡é€Ÿè¯»

## 0. åŸºæœ¬ä¿¡æ¯
- **å‘è¡¨æ—¶é—´**: 2023å¹´ (CVPR 2023 Best Paper)
- **ä½œè€…å•ä½**: OpenDriveLab (ä¸Šæµ·äººå·¥æ™ºèƒ½å®éªŒå®¤)
- **ä»£ç ä»“åº“**: [https://github.com/OpenDriveLab/UniAD](https://github.com/OpenDriveLab/UniAD)
- **Tags**: #ç«¯åˆ°ç«¯è‡ªåŠ¨é©¾é©¶ #å¤§ç»Ÿä¸€Transformer #æ¨¡å—åŒ–è§£è€¦ #è§„æ§å¯¼å‘æ„ŸçŸ¥

---

## 1. ğŸ”ª ä»Šæ—¥é”è¯„
> **UniAD** æ˜¯è‡ªåŠ¨é©¾é©¶æ„ŸçŸ¥çš„â€œå¤§ä¸€ç»Ÿç†è®ºâ€ã€‚
> 
> **æ ¸å¿ƒæ´å¯Ÿ**ï¼šåœ¨ UniAD ä¹‹å‰ï¼Œå„æ¨¡å—ï¼ˆæ£€æµ‹ã€é¢„æµ‹ç­‰ï¼‰æ˜¯å‰²è£‚çš„ï¼Œè¯¯å·®ä¼šé€çº§ä¼ é€’ã€‚UniAD ç¬¬ä¸€æ¬¡å®ç°äº† **â€œQuery çš„å…¨é“¾è·¯é€šä¿¡â€**ã€‚å®ƒè¯æ˜äº†ï¼šæ„ŸçŸ¥ä¸åº”è¯¥æ˜¯å­¤ç«‹çš„ä»»åŠ¡ï¼Œæ„ŸçŸ¥çš„æ¯ä¸€æ¯”ç‰¹ä¿¡æ¯éƒ½åº”è¯¥ä¸ºæœ€åçš„è§„åˆ’ï¼ˆPlanningï¼‰æœåŠ¡ã€‚
> 
> **ä¸€å¥è¯æ€»ç»“**ï¼šå®ƒä¸ä»…æ£€æµ‹åˆ°äº†éšœç¢ç‰©ï¼Œè¿˜é€šè¿‡ Query å‘Šè¯‰è§„åˆ’å™¨è¯¥éšœç¢ç‰©æœªæ¥ 5 ç§’å¯èƒ½å‡ºç°åœ¨å“ªï¼Œä»¥åŠå®ƒå¯¹ ego-vehicle äº§ç”Ÿçš„ Occupancy é£é™©ã€‚

---

## 2. ğŸ—ï¸ æ¨¡å‹æ¶æ„ (Architecture Map)
![UniAD Architecture](https://github.com/OpenDriveLab/UniAD/raw/main/figs/uniad_framework.png)
*Figure 1: UniAD æ•´ä½“æµæ°´çº¿ã€‚åŒ…å« TrackFormer, MapFormer, MotionFormer, OccFormer ä»¥åŠæœ€ç»ˆçš„ Plannerã€‚*

### **è¯¦ç»†æ–‡å­—æè¿°ï¼š**
1. **BEV Encoder**: åŸºäº BEVFormer çš„æ—¶ç©ºç¼–ç å™¨æå–ç‰¹å¾ã€‚
2. **Unified Query Pipeline (æ ¸å¿ƒ)**:
   - **TrackFormer**: åˆ©ç”¨ Object Queries è¿›è¡Œå¤šç›®æ ‡è¿½è¸ªã€‚
   - **MapFormer**: åˆ©ç”¨ Map Queries è¿›è¡Œå®æ—¶è½¦é“çº¿ä¸æ‹“æ‰‘å»ºå›¾ã€‚
   - **MotionFormer**: å°† Track å’Œ Map çš„ Query èåˆï¼Œé¢„æµ‹æ‰€æœ‰å‚ä¸è€…çš„å¤šæ¨¡æ€æœªæ¥è½¨è¿¹ã€‚
   - **OccFormer**: åŸºäºä»£ç†è¯­ä¹‰é¢„æµ‹æœªæ¥ç©ºé—´çš„å æ®æƒ…å†µï¼ˆOccupancy Gridï¼‰ã€‚
3. **Planner Head**: Ego-query ä¸ä¸Šè¿°æ‰€æœ‰ä¸­é—´å±‚ç‰¹å¾äº¤äº’ï¼Œè¾“å‡ºé¿éšœåçš„æœ€ä¼˜è½¨è¿¹ã€‚

---

## 3. ğŸ’¡ æ ¸å¿ƒåˆ›æ–° (Math & Pseudo-code)

### 3.1 å±‚æ¬¡åŒ– Query é€šä¿¡ (Query Communication)
**é€»è¾‘**ï¼šä¸Šæ¸¸ä»»åŠ¡ç”Ÿæˆçš„ Query ç›´æ¥ä½œä¸ºä¸‹æ¸¸ä»»åŠ¡çš„è¾“å…¥ï¼Œå®ç°ä¿¡æ¯çš„æ— æŸä¼ é€’ã€‚

**PyTorch é£æ ¼ä¼ªä»£ç å®ç°**ï¼š
```python
def forward_uniad(bev_feats):
    # 1. è·Ÿè¸ªä¸æ£€æµ‹
    # agent_queries: [N, C]
    agent_queries = self.track_former(bev_feats)
    
    # 2. åœ¨çº¿å»ºå›¾
    # map_queries: [M, C]
    map_queries = self.map_former(bev_feats)
    
    # 3. è½¨è¿¹é¢„æµ‹ (èåˆ Agent ä¸ Map ä¿¡æ¯)
    # é€šè¿‡äº¤äº’ï¼ŒAgent çŸ¥é“äº†è·¯ç½‘æ‹“æ‰‘çº¦æŸ
    pred_trajectories = self.motion_former(agent_queries, map_queries)
    
    # 4. å æ®ç©ºé—´é¢„æµ‹ (æœªæ¥æ—¶ç©ºé£é™©å›¾)
    future_occ = self.occ_former(bev_feats, agent_queries)
    
    # 5. è§„æ§ (Ego-planning)
    # ego_query å­¦ä¹ å¦‚ä½•åœ¨ map å’Œ occ ä¸­ç©¿è¡Œ
    final_plan = self.planner(bev_feats, agent_queries, map_queries, future_occ)
    
    return final_plan
```

---

## 4. ğŸ“‰ Loss å‡½æ•°è¯¦è§£
$$L = \lambda_1 L_{track} + \lambda_2 L_{map} + \lambda_3 L_{motion} + \lambda_4 L_{occ} + \lambda_5 L_{planning}$$
- **$L_{planning}$ (æ ¸å¿ƒ)**ï¼šåŒ…å« **L2 Imitation Loss**ï¼ˆå‘äººç±»ä¸“å®¶å­¦ä¹ è½¨è¿¹ï¼‰å’Œ **Collision Avoidance Loss**ï¼ˆåˆ©ç”¨é¢„æµ‹çš„ Occ è¿›è¡Œæ˜¾å¼é¿éšœæƒ©ç½šï¼‰ã€‚

---

## 5. ğŸ“Š å…³é”®æŒ‡æ ‡ (nuScenes)
| ä»»åŠ¡ | æŒ‡æ ‡ | UniAD è¡¨ç° | å¤‡æ³¨ |
| :--- | :--- | :--- | :--- |
| **Planning** | Avg. L2 Error â†“ | **0.71m** | ç›¸æ¯”ä¼ ç»Ÿæ¨¡å—åŒ–æ–¹æ¡ˆé™ä½ 38% |
| **Planning** | Collision Rate â†“ | **0.31%** | æ˜¾è‘—ä¼˜äºé E2E æ–¹æ¡ˆ |
| **Motion** | minADE (5s) â†“ | **0.71** | é¢„æµ‹æ›´ç²¾å‡† |

---

## 10. ğŸ› ï¸ è½åœ°å»ºè®®
- **ç®—å­åˆå¹¶**: ç”±äºæ¨¡å‹ææ·±ï¼Œå»ºè®®åœ¨éƒ¨ç½²æ—¶å°†å¤šä¸ª Transformer Decoder åˆå¹¶ä¸ºå•ä¸€çš„ TensorRT å¼•æ“ï¼Œå‡å°‘ä»»åŠ¡é—´çš„ Context Switchã€‚
- **å†·å¯åŠ¨**: ä¾èµ–å†å²å¸§ï¼Œåœ¨è½¦è¾†åˆšåˆšä¸Šç”µå¯åŠ¨çš„å‰å‡ å¸§ï¼Œè§„åˆ’ç²¾åº¦ä¼šæœ‰æ‰€æ³¢åŠ¨ï¼Œå»ºè®®é¢„çƒ­ Bufferã€‚
